<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>测试 WebAssembly.instantiate 以及asm.js</title>
</head>
<body>

<!-- 测试 WebAssembly.instantiate -->
<!--<script>-->
    <!--//emcc demo2.c -s ONLY_MY_CODE=1 -s WASM=1 -s EXTRA_EXPORTED_RUNTIME_METHODS='["UTF8ToString"]' -s EXPORTED_FUNCTIONS="['_bezier1','_hello']"  -o demo2.js-->
    <!--const memory = new WebAssembly.Memory({ initial: 256, maximum: 256 });-->
    <!--const importObj = {-->
        <!--env: {-->
            <!--abortStackOverflow: () => { throw new Error('overflow'); },-->
            <!--table: new WebAssembly.Table({ initial: 0, maximum: 0, element: 'anyfunc' }),-->
            <!--tableBase: 0,-->
            <!--memory: memory,-->
            <!--memoryBase: 1024,-->
            <!--STACKTOP: 0,-->
            <!--STACK_MAX: memory.buffer.byteLength,-->
        <!--}-->
    <!--};-->
    <!--fetch('demo2.wasm').then((response) => response.arrayBuffer())-->
            <!--.then((bytes) => WebAssembly.instantiate(bytes, importObj))-->
            <!--.then((wa) => alert(wa.instance.exports._bezier1(0.5, 10, 20)));-->
<!--</script>-->

<!-- 测试ams.js -->
<script type="text/javascript" src="demo2.js"></script>
<script>
    Module['onRuntimeInitialized'] = function() {
        console.log(Module._bezier1(0.5, 10, 20));

        console.log(Module._hello())

        console.log(Module.UTF8ToString(Module._hello()))
    };
</script>
</body>
</html>